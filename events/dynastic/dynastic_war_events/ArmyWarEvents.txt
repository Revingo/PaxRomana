namespace = ArmyWarEvent
ArmyWarEvent.0001 = {
	type = letter_event
	sender = scope:faction_leader
	opening = {
		desc = "FACTION_DEMAND_CLAIMANT"
	}
	desc = "FACTION_DEMAND_CLAIMANT_DESC_ME"
	
	trigger = {
		exists = scope:faction
	}

	immediate = {
		set_variable = {
			name = claimant_faction_sent_demand
			value = scope:faction_leader
		}
	}

	option = {
		name = "FACTION_DEMAND_ACCEPT"

		# This effect should always be placed here, _before_ all the other effects in the block.
		trigger_event = { on_action = on_faction_demand_accepted }

		add_dread = medium_dread_loss

		# LEGITIMACY LOSS FOR ACCEPTING FACTION DEMANDS
		faction_accept_demand_legitimacy_effect = yes

		
		scope:faction.faction_target = {
			create_title_and_vassal_change = {
				type = conquest
				save_scope_as = changed_title
				add_claim_on_loss = yes
			}

			primary_title = {
				change_title_holder_include_vassals = {
					holder = scope:faction_leader
					change = changed_title
				}
			}
		}

		ai_chance = {
			base = 10
			#modifier = {
			#	add = 50
			#	scope:faction = { faction_power >= 125 }
			#}
			#modifier = {
			#	add = 50
			#	scope:faction = { faction_power >= 150 }
			#}
			#modifier = {
			#	add = 50
			#	scope:faction = { faction_power >= 200 }
			#}
			#modifier = {
			#	factor = 0
			#	any_ally = {
			#		NOR = {
			#			target_is_liege_or_above = root
			#			target_is_vassal_or_below = root
			#		}
			#		max_military_strength > root.max_military_strength
			#	}
			#}
			#modifier = {
			#	add = -25
			#	is_at_war = no
			#	scope:faction_target.primary_title.tier >= tier_kingdom
			#}
			#modifier = {
			#	add = -50
			#	is_at_war = no
			#	scope:faction_target.primary_title.tier >= tier_empire
			#}
			#modifier = {
			#	add = -5000
			#	OR = {
			#		has_title = title:e_roman_respublica
			#		has_title = title:e_alexander_makedon
			#	}
			#}
		}
	}

	option = {
		name = "FACTION_DEMAND_REFUSE"

		# This effect should always be placed here, _before_ all the other effects in the block.
		trigger_event = { on_action = on_faction_demand_rejected }
		
		root = {
			save_scope_as = faction_target
		}

		show_as_tooltip = {
			scope:faction = {
				faction_start_war = {
					title = scope:faction_targeted_title
				}
				faction_spawn_member_county_armies_effect = {
					FACTION = scope:faction
					ARMY_OWNER = scope:faction_leader
					PEASANT_ARMY_NAME = claimant_faction_event_troops
				}
			}
		}
		
		scope:faction_leader = {
			trigger_event = faction_demand.2003
		}

		ai_chance = {
			base = 100
			#compare_modifier = {
			#	trigger = {
			#		ai_boldness > 0
			#	}
			#	value = ai_boldness
			#	multiplier = 3
			#}
			#compare_modifier = {
			#	trigger = {
			#		ai_boldness < 0
			#	}
			#	value = ai_boldness
			#}
			#modifier = {
			#	add = 50
			#	scope:faction = { faction_power < 80 }
			#}
			#modifier = {
			#	add = 100
			#	scope:faction = { faction_power < 60 }
			#}
			#modifier = {
			#	add = 1000
			#	scope:faction = { faction_power < 40 }
			#}
			#modifier = {
			#	add = 5000
			#	OR = {
			#		has_title = title:e_roman_respublica
			#		has_title = title:e_alexander_makedon
			#	}
			#}
		}
	}

	after = {
		remove_variable = claimant_faction_sent_demand
	}
}

ArmyWarEvent.2000 = {
	type = letter_event
	sender = scope:faction_leader
	opening = {
		desc = "FACTION_DEMAND_CLAIMANT_SEND_DEMAND_NOTIFICATION"
	}
	desc = "FACTION_DEMAND_CLAIMANT_SEND_DEMAND_NOTIFICATION_DESC_test"

	option = {
		name = "FACTION_DEMAND_SEND_DEMAND_NOTIFICATION_OPT"	
	}
}

ArmyWarEvent.2001 = {
	type = letter_event
	sender = scope:faction_leader
	# TODO make the event that tells the faction target that the army uprising has started
	opening = {
		desc = "FACTION_DEMAND_CLAIMANT_SEND_DEMAND_NOTIFICATION"
	}
	desc = "FACTION_DEMAND_CLAIMANT_SEND_DEMAND_NOTIFICATION_DESC_test"

	option = {
		name = "FACTION_DEMAND_SEND_DEMAND_NOTIFICATION_OPT"	
	}
}