on_marriage = {
	on_actions = {
		on_family_traitor
	}
}

on_family_traitor = {
	trigger = {
		AND = {
			#Checks if the character already has the family_traitor modifier
			NOT = {has_character_modifier = family_traitor}
	
			#if he has not, checks if his culture has the tradition_pure_family tradition, then checks
			culture = {
				has_cultural_tradition = tradition_pure_family
			}
			#if the scope's house is the same of the scope's primary spouse's house
			NOT = { house = primary_spouse.house }
		}
	}

	#if all conditions are met, fires the familyTraitorEvent.1
	events = {
		familyTraitorEvent.1
	}
}

on_create_league = {
	trigger = {
		is_ruler = yes
		highest_held_title_tier >= 2
		government_has_flag = government_is_city-state
		NOT = {has_variable_list = league_list }
		NOT = {has_variable = in_a_league }
	}

	effect = {
		add_to_list = league_list
		set_variable = {
			name = in_a_league
			value = yes
		}
		set_variable = {
			name = is_league_leader
			value = yes
		}
	}
}

on_add_to_league = {
	trigger = {
		is_ruler = yes
		highest_held_title_tier >= 2
		government_has_flag = government_is_city-state
		NOT = {has_variable_list = league_list }
		NOT = {has_variable = in_a_league }
	}

	effect = {
		set_variable = {
			name = in_a_league
			value = root.primary_title
		}
		set_variable = {
			name = is_league_leader
			value = no
		}
	}
}