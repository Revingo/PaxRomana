create_league_gui = {
	scope = character

	#trigger_event = {
	#	on_action = on_create_league
	#}
	effect = {
		add_to_variable_list = {
			name = league_list
			target = root
		}
		set_variable = {
			name = in_a_league
			value = yes
		}
		set_variable = {
			name = is_league_leader
			value = yes
		}
		add_character_modifier = {
			modifier = league_funds
		}
		set_variable = {
			name = funds_value
			value = 300
		}
	}

	is_shown = {
		NOT = {
			OR = {
				AND = {
					has_variable = in_a_league
					var:in_a_league = yes
				}
				AND = {
					has_variable = is_league_leader
					var:is_league_leader = yes
				}
			}
		}
	}
}

is_league_leader_gui = {
	scope = character

	is_shown = {
		AND = {
			has_variable = is_league_leader
			var:is_league_leader = yes 

		}
	}
}

take_league_loan_owner_gui = {
	scope = character

	effect = {
		change_variable = {
			name = funds_value
			subtract = 300
		}
		add_gold = 300
		every_in_list = {
			variable = league_list

			if = {
				limit = { NOT = {this = root} }

				add_opinion = {
					target = root
					modifier = took_some_league_funds_opinion
				}
			}
		}
	}

	is_valid = {
		var:funds_value >= 300
	}
}

take_league_loan_gui = {
	scope = character

	effect = {
		var:league_owner = {
			change_variable = {
				name = funds_value
				subtract = 300
			}
			every_in_list = {
				variable = league_list
	
				if = {
					limit = { NOT = { this = root } }
	
					add_opinion = {
						target = root
						modifier = took_some_league_funds_opinion
					}
					
				}
			}
		}
		add_gold = 300

		
	}

	is_valid = {
		var:league_owner.var:funds_value >= 300
	}
}

usurp_leader_gui = {
	scope = character

	is_valid = {
		OR = {
			auctoritas_value > {
				value = root.var:league_owner.auctoritas_value
				multiply = 3
			}
			AND = {
				auctoritas_value > 0
				root.var:league_owner.auctoritas_value < 0
			}
		}
		
	}

	effect = {
		change_variable = {
			name = is_league_leader
			value = yes
		}
		set_variable = {
			name = funds_value
			value = root.var:league_owner.funds_value
		}
		add_to_variable_list = {
			name = league_list
			value = root
		}
		

		root.var:league_owner = {
			every_in_list = {
				variable = league_list

				if = {
					limit = { NOT = { this = root }}
					
					root = {
						add_to_variable_list = {
							name = league_list
							value = this
						}
					}
				}
			}

			set_variable = {
				name = league_owner
				value = root
			}
			change_variable = {
				name = is_league_leader
				value = no
			}
			remove_variable = funds_value
			delete_list = {
				variable = league_list
			}
		}

		every_in_list = {
			variable = league_list

			if = {
				limit = { NOT = { this = root }}

				change_variable = {
					name = league_owner
					value = root
				}
			}
		}

		remove_variable = league_owner
	}
}